<mxfile host="app.diagrams.net" modified="2024-01-01T00:00:00.000Z" agent="Claude" version="22.0.0">
  <diagram name="Summary Validation Flow" id="summary-validation-flow">
    <mxGraphModel dx="1800" dy="1600" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1800" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Summary Publication Validation Pipeline" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="500" height="40" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="Industry Best Practice: Multi-Stage LLM Output Validation" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="500" y="55" width="500" height="25" as="geometry" />
        </mxCell>

        <!-- ==================== INPUT ==================== -->
        <mxCell id="input-box" value="INPUT: DRAFT SUMMARY" style="swimlane;fontStyle=1;startSize=30;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="100" width="300" height="140" as="geometry" />
        </mxCell>
        <mxCell id="input-draft" value="Generated Summary Draft&#xa;(from content generation step)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="60" y="140" width="260" height="40" as="geometry" />
        </mxCell>
        <mxCell id="input-sources" value="Source Documents&#xa;(doc_ids, titles, content)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="60" y="190" width="260" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== STEP 1: SOURCE ATTRIBUTION ==================== -->
        <mxCell id="step1-box" value="STEP 1: SOURCE ATTRIBUTION VALIDATION" style="swimlane;fontStyle=1;startSize=30;fillColor=#d5e8d4;strokeColor=#82b366;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="400" y="100" width="450" height="280" as="geometry" />
        </mxCell>
        <mxCell id="step1-purpose" value="Purpose: Ensure every factual claim is traceable to source documents&#xa;(Hallucination Prevention)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="420" y="140" width="410" height="40" as="geometry" />
        </mxCell>
        <mxCell id="step1-prompt" value="LLM Prompt (gpt-4o-mini):&#xa;&#xa;&quot;For each factual claim in the summary, identify:&#xa;1. The exact claim being made&#xa;2. The source document ID that supports it&#xa;3. The specific quote or passage from the source&#xa;&#xa;If a claim cannot be traced to any source document,&#xa;mark it as UNSOURCED.&quot;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="420" y="190" width="410" height="120" as="geometry" />
        </mxCell>
        <mxCell id="step1-output" value="Output: { claims: [{ claim, doc_id, quote, verified: bool }],&#xa;          unsourced_ratio: 0.15 }" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="420" y="320" width="410" height="40" as="geometry" />
        </mxCell>

        <!-- Step 1 Decision -->
        <mxCell id="step1-decision" value="unsourced_ratio&#xa;&gt; 20%?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="560" y="400" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="step1-regenerate" value="REGENERATE&#xa;with source constraints" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="740" y="415" width="160" height="50" as="geometry" />
        </mxCell>

        <!-- ==================== STEP 2: AP STYLE COMPLIANCE ==================== -->
        <mxCell id="step2-box" value="STEP 2: AP STYLE COMPLIANCE CHECK" style="swimlane;fontStyle=1;startSize=30;fillColor=#ffe6cc;strokeColor=#d79b00;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="520" width="400" height="340" as="geometry" />
        </mxCell>
        <mxCell id="step2-purpose" value="Purpose: Enforce journalistic objectivity and style standards" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="60" y="560" width="360" height="30" as="geometry" />
        </mxCell>
        <mxCell id="step2-checks" value="Violation Checks:&#xa;&#xa;âŒ Subjective Adjectives&#xa;   &quot;significant&quot;, &quot;important&quot;, &quot;strategic&quot;,&#xa;   &quot;crucial&quot;, &quot;major&quot;, &quot;key&quot;&#xa;&#xa;âŒ Editorializing Phrases&#xa;   &quot;This shows that...&quot;, &quot;Clearly...&quot;,&#xa;   &quot;It is evident...&quot;, &quot;Notably...&quot;&#xa;&#xa;âŒ Unattributed Speculation&#xa;   Future predictions without &quot;X said&quot; or &quot;according to&quot;&#xa;&#xa;âŒ Improper Tense&#xa;   Present tense for past events&#xa;&#xa;âœ“ Required: Past tense, attribution, specific facts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="600" width="360" height="200" as="geometry" />
        </mxCell>
        <mxCell id="step2-output" value="Output: { compliant: bool, violations: [...],&#xa;          suggested_fixes: [...] }" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="60" y="810" width="360" height="40" as="geometry" />
        </mxCell>

        <!-- Step 2 Decision -->
        <mxCell id="step2-decision" value="compliant?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="170" y="880" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="step2-fix" value="AUTO-FIX&#xa;Apply suggested fixes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="40" y="895" width="110" height="45" as="geometry" />
        </mxCell>

        <!-- ==================== STEP 3: FACTUAL GROUNDING ==================== -->
        <mxCell id="step3-box" value="STEP 3: FACTUAL GROUNDING VALIDATION" style="swimlane;fontStyle=1;startSize=30;fillColor=#e1d5e7;strokeColor=#9673a6;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="520" width="400" height="340" as="geometry" />
        </mxCell>
        <mxCell id="step3-purpose" value="Purpose: Verify all entities, dates, and figures exist in sources&#xa;(Prevent fabricated facts)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="500" y="560" width="360" height="40" as="geometry" />
        </mxCell>
        <mxCell id="step3-extract" value="Extraction Targets:&#xa;&#xa;â€¢ Named Entities&#xa;  - Person names (officials, leaders)&#xa;  - Organization names (agencies, companies)&#xa;  - Location names (cities, countries)&#xa;&#xa;â€¢ Numerical Data&#xa;  - Dates and times&#xa;  - Financial figures ($X million, etc.)&#xa;  - Quantities and percentages&#xa;&#xa;â€¢ Specific Claims&#xa;  - Agreements signed&#xa;  - Statements made&#xa;  - Actions taken" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;align=left;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="500" y="610" width="360" height="180" as="geometry" />
        </mxCell>
        <mxCell id="step3-output" value="Output: { entities_verified: X, entities_unverified: Y,&#xa;          unverified_list: [...], grounding_score: 0.92 }" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="500" y="800" width="360" height="45" as="geometry" />
        </mxCell>

        <!-- Step 3 Decision -->
        <mxCell id="step3-decision" value="grounding&#xa;&gt; 90%?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="620" y="880" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="step3-remove" value="REMOVE&#xa;ungrounded facts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="750" y="890" width="110" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== STEP 4: COMPLETENESS CHECK ==================== -->
        <mxCell id="step4-box" value="STEP 4: COMPLETENESS &amp; STRUCTURE VALIDATION" style="swimlane;fontStyle=1;startSize=30;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="920" y="100" width="380" height="280" as="geometry" />
        </mxCell>
        <mxCell id="step4-purpose" value="Purpose: Ensure structural quality and required sections" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="940" y="140" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="step4-checks" value="Structural Checks:&#xa;&#xa;âœ“ All required sections present&#xa;  - Overview (2-3 sentences)&#xa;  - Outcomes (2-3 sentences)&#xa;  - [Weekly: Progression]&#xa;  - [Monthly: Strategic Significance]&#xa;&#xa;âœ“ Length constraints&#xa;  - Min: 50 words per section&#xa;  - Max: 200 words per section&#xa;&#xa;âœ“ No placeholder text&#xa;  - &quot;[TBD]&quot;, &quot;TODO&quot;, &quot;...&quot;&#xa;&#xa;âœ“ Complete sentences&#xa;  - No fragments or cut-offs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="940" y="180" width="340" height="190" as="geometry" />
        </mxCell>

        <!-- ==================== STEP 5: CONFIDENCE SCORING ==================== -->
        <mxCell id="step5-box" value="STEP 5: CONFIDENCE SCORING &amp; ROUTING" style="swimlane;fontStyle=1;startSize=30;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="920" y="420" width="380" height="340" as="geometry" />
        </mxCell>
        <mxCell id="step5-purpose" value="Purpose: Calculate overall quality score and route appropriately" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="940" y="460" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="step5-formula" value="Confidence Score Calculation:&#xa;&#xa;confidence = (&#xa;  0.35 Ã— source_attribution_score +&#xa;  0.25 Ã— ap_style_compliance_score +&#xa;  0.25 Ã— factual_grounding_score +&#xa;  0.15 Ã— completeness_score&#xa;)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;spacingLeft=10;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="940" y="500" width="340" height="110" as="geometry" />
        </mxCell>
        <mxCell id="step5-flags" value="Human Review Flags:&#xa;&#xa;ðŸš© Confidence &lt; 0.80&#xa;ðŸš© Any unsourced claims on sensitive topics&#xa;ðŸš© Military or large financial content (&gt;$100M)&#xa;ðŸš© Conflicting information in sources&#xa;ðŸš© Material score disagrees with content tone" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;align=left;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="940" y="620" width="340" height="120" as="geometry" />
        </mxCell>

        <!-- ==================== OUTPUT ROUTING ==================== -->
        <mxCell id="routing-decision" value="confidence&#xa;â‰¥ 0.80?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="560" y="1000" width="120" height="80" as="geometry" />
        </mxCell>

        <!-- Auto-publish path -->
        <mxCell id="auto-publish" value="AUTO-PUBLISH" style="swimlane;fontStyle=1;startSize=25;fillColor=#d5e8d4;strokeColor=#82b366;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="320" y="1120" width="200" height="120" as="geometry" />
        </mxCell>
        <mxCell id="auto-details" value="âœ… All validations passed&#xa;âœ… Confidence â‰¥ 0.80&#xa;âœ… No sensitive content flags&#xa;&#xa;â†’ Publish to dashboard&#xa;â†’ Log validation metrics" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;spacingLeft=5;" vertex="1" parent="1">
          <mxGeometry x="330" y="1150" width="180" height="80" as="geometry" />
        </mxCell>

        <!-- Human review path -->
        <mxCell id="human-review" value="HUMAN REVIEW QUEUE" style="swimlane;fontStyle=1;startSize=25;fillColor=#f8cecc;strokeColor=#b85450;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="720" y="1120" width="200" height="120" as="geometry" />
        </mxCell>
        <mxCell id="human-details" value="âš ï¸ Confidence &lt; 0.80&#xa;âš ï¸ Sensitive content detected&#xa;âš ï¸ Validation flags raised&#xa;&#xa;â†’ Queue for editor review&#xa;â†’ Include validation report" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;spacingLeft=5;" vertex="1" parent="1">
          <mxGeometry x="730" y="1150" width="180" height="80" as="geometry" />
        </mxCell>

        <!-- ==================== VALIDATION REPORT ==================== -->
        <mxCell id="report-box" value="VALIDATION REPORT (Stored with Summary)" style="swimlane;fontStyle=1;startSize=25;fillColor=#f5f5f5;strokeColor=#666666;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="1000" width="240" height="240" as="geometry" />
        </mxCell>
        <mxCell id="report-content" value="{&#xa;  &quot;summary_id&quot;: &quot;...&quot;,&#xa;  &quot;validation_timestamp&quot;: &quot;...&quot;,&#xa;  &quot;confidence_score&quot;: 0.87,&#xa;  &quot;source_attribution&quot;: {&#xa;    &quot;score&quot;: 0.95,&#xa;    &quot;claims_verified&quot;: 12,&#xa;    &quot;claims_unsourced&quot;: 1&#xa;  },&#xa;  &quot;ap_style_compliance&quot;: {&#xa;    &quot;score&quot;: 0.90,&#xa;    &quot;violations_fixed&quot;: 2&#xa;  },&#xa;  &quot;factual_grounding&quot;: {&#xa;    &quot;score&quot;: 0.92,&#xa;    &quot;entities_verified&quot;: 15&#xa;  },&#xa;  &quot;requires_human_review&quot;: false,&#xa;  &quot;flags&quot;: []&#xa;}" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontFamily=Courier New;spacingLeft=5;" vertex="1" parent="1">
          <mxGeometry x="50" y="1030" width="220" height="200" as="geometry" />
        </mxCell>

        <!-- ==================== ARROWS ==================== -->

        <!-- Input to Step 1 -->
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;" edge="1" parent="1" source="input-box" target="step1-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Step 1 to Decision -->
        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="step1-output" target="step1-decision">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Step 1 Decision to Regenerate -->
        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;" edge="1" parent="1" source="step1-decision" target="step1-regenerate">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3-label" value="YES" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="690" y="420" width="40" height="20" as="geometry" />
        </mxCell>

        <!-- Regenerate back to Step 1 -->
        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;dashed=1;" edge="1" parent="1" source="step1-regenerate" target="step1-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="900" y="440" />
              <mxPoint x="900" y="90" />
              <mxPoint x="625" y="90" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Step 1 Decision NO to Step 2 -->
        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;" edge="1" parent="1" source="step1-decision" target="step2-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="620" y="500" />
              <mxPoint x="300" y="500" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow5-label" value="NO (PASS)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="550" y="470" width="60" height="20" as="geometry" />
        </mxCell>

        <!-- Step 1 to Step 4 (parallel) -->
        <mxCell id="arrow-parallel1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#6c8ebf;dashed=1;" edge="1" parent="1" source="step1-box" target="step4-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Step 2 to Decision -->
        <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="step2-output" target="step2-decision">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Step 2 Fix loop -->
        <mxCell id="arrow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;" edge="1" parent="1" source="step2-decision" target="step2-fix">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow7-label" value="NO" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="130" y="895" width="30" height="20" as="geometry" />
        </mxCell>

        <!-- Step 2 to Step 3 -->
        <mxCell id="arrow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;" edge="1" parent="1" source="step2-decision" target="step3-decision">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="220" y="960" />
              <mxPoint x="450" y="960" />
              <mxPoint x="450" y="910" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow8-label" value="YES (PASS)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="260" y="905" width="70" height="20" as="geometry" />
        </mxCell>

        <!-- Step 3 Decision -->
        <mxCell id="arrow9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;" edge="1" parent="1" source="step3-decision" target="step3-remove">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow9-label" value="NO" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="720" y="895" width="30" height="20" as="geometry" />
        </mxCell>

        <!-- Step 3 to Step 5 -->
        <mxCell id="arrow10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;" edge="1" parent="1" source="step3-decision" target="step5-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="670" y="960" />
              <mxPoint x="910" y="960" />
              <mxPoint x="910" y="590" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Step 4 to Step 5 -->
        <mxCell id="arrow11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#6c8ebf;" edge="1" parent="1" source="step4-box" target="step5-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Step 5 to Final Decision -->
        <mxCell id="arrow12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;" edge="1" parent="1" source="step5-box" target="routing-decision">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1110" y="780" />
              <mxPoint x="1110" y="980" />
              <mxPoint x="620" y="980" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Final Decision to Auto-publish -->
        <mxCell id="arrow13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#82b366;" edge="1" parent="1" source="routing-decision" target="auto-publish">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow13-label" value="YES" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="470" y="1080" width="40" height="20" as="geometry" />
        </mxCell>

        <!-- Final Decision to Human Review -->
        <mxCell id="arrow14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;strokeColor=#b85450;" edge="1" parent="1" source="routing-decision" target="human-review">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow14-label" value="NO" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="690" y="1080" width="40" height="20" as="geometry" />
        </mxCell>

        <!-- ==================== LEGEND ==================== -->
        <mxCell id="legend-box" value="LEGEND" style="swimlane;fontStyle=1;startSize=25;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1340" y="100" width="180" height="180" as="geometry" />
        </mxCell>
        <mxCell id="legend-pass" value="Validation Pass" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1360" y="135" width="100" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend-fail" value="Validation Fail" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1360" y="170" width="100" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend-decision" value="Decision" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1360" y="205" width="80" height="40" as="geometry" />
        </mxCell>

        <!-- Thresholds Box -->
        <mxCell id="thresholds-box" value="VALIDATION THRESHOLDS" style="swimlane;fontStyle=1;startSize=25;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="1340" y="300" width="180" height="160" as="geometry" />
        </mxCell>
        <mxCell id="thresholds-content" value="Source Attribution: â‰¥ 80%&#xa;AP Style Compliance: 100%&#xa;Factual Grounding: â‰¥ 90%&#xa;Completeness: 100%&#xa;&#xa;Overall Confidence: â‰¥ 0.80&#xa;for auto-publish" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1350" y="330" width="160" height="120" as="geometry" />
        </mxCell>

        <!-- LLM Calls Summary -->
        <mxCell id="llm-box" value="LLM CALLS PER SUMMARY" style="swimlane;fontStyle=1;startSize=25;fillColor=#e1d5e7;strokeColor=#9673a6;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="1340" y="480" width="180" height="140" as="geometry" />
        </mxCell>
        <mxCell id="llm-content" value="1. Content Generation&#xa;2. Source Attribution&#xa;3. AP Style Check&#xa;4. Factual Grounding&#xa;5. Completeness Check&#xa;&#xa;Model: gpt-4o-mini" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="1350" y="510" width="160" height="100" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
